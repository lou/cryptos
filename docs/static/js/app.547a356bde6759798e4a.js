webpackJsonp([1],{NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("7+uW"),c=r("Dd8w"),o=r.n(c),a=r("mvHQ"),u=r.n(a),i=r("NYxO"),s=r("M4fF"),l=r.n(s),d=r("mtWM"),p=r.n(d),m=r("Av7u"),y=r.n(m),f=r("TOa9"),v=r.n(f);n.default.use(i.a);var b=[{key:"cost",name:"Cost",sortFunction:function(e){return parseFloat(e.cost)}},{key:"performance",name:"Performance",sortFunction:function(e){return(parseFloat(e.coinmarketcap.price_eur)*parseFloat(e.quantity)-e.cost)/e.cost}},{key:"value",name:"Value",sortFunction:function(e){return parseFloat(e.coinmarketcap.price_eur)*parseFloat(e.quantity)}},{key:"price_eur",name:"Price",sortFunction:function(e){return parseFloat(e.coinmarketcap.price_eur)}}],h={id:null,name:null,quantity:null,cost:null,info:null,tags:[]},_=new i.a.Store({state:{password:"",sort:{by:"cost",ascending:!1},filters:{tags:[]},allCurrencies:[],currencies:[]},mutations:{initialiseStore:function(e){var t=document.location.pathname.substr(1);if(t){var r=v.a.decompressFromEncodedURIComponent(t),n=y.a.AES.decrypt(r.toString(),"");try{var c=JSON.parse(n.toString(y.a.enc.Utf8));this.replaceState(o()({},e,c)),this.dispatch("fetchCurrencies")}catch(e){console.log("WRONG PASSWORD")}}},updateSort:function(e,t){e.sort.ascending=t===e.sort.by&&!e.sort.ascending,e.sort.by=t},updateTags:function(e,t){e.filters.tags=t},addCurrency:function(e,t){l.a.isEmpty(t.currency.id)||(e.currencies.push(t.currency),"function"==typeof t.callback&&t.callback())},updateCurrency:function(e,t){e.currencies.splice(l.a.findIndex(e.currencies,{id:t.currency.id}),1,t.currency),"function"==typeof t.callback&&t.callback()},removeCurrency:function(e,t){e.currencies=l.a.reject(e.currencies,{id:t.id})},setAllCurrencies:function(e,t){e.allCurrencies=t}},actions:{fetchAllCurrencies:function(e){var t=e.commit;p.a.get("https://files.coinmarketcap.com/generated/search/quick_search.json").then(function(e){t("setAllCurrencies",e.data)})},fetchCurrency:function(e,t){var r=e.commit;p.a.get("https://api.coinmarketcap.com/v1/ticker/"+t.currency.id+"/?convert=EUR").then(function(e){t.currency.coinmarketcap=e.data[0],r(t.method,{currency:t.currency,callback:t.callback})})},fetchCurrencies:function(e){var t=e.dispatch;e.state.currencies.forEach(function(e){t("fetchCurrency",{currency:e,method:"updateCurrency",bypassEncodeURL:!0})})}},getters:{total:function(e,t){var r=l.a.sumBy(t.filteredCurrencies,function(e){return e.coinmarketcap.price_eur*e.quantity||0}),n=l.a.sumBy(t.filteredCurrencies,function(e){return parseFloat(e.cost)||0});return{cost:n,value:r,performance:(r-n)/n}},tags:function(e){return l.a.uniq(l.a.flatten(l.a.map(e.currencies,function(e){return e.tags})))},filteredCurrencies:function(e){var t=e.currencies.sort(function(t,r){var n=l.a.find(b,{key:e.sort.by});return n.sortFunction(t)>n.sortFunction(r)?1:n.sortFunction(t)<n.sortFunction(r)?-1:0});return e.sort.ascending||t.reverse(),l.a.isEmpty(e.filters.tags)||(t=l.a.filter(t,function(t){return l.a.intersection(t.tags,e.filters.tags).length>=1})),t}}}),C=["allCurrencies","password","updateSort","updateTags","addCurrency","removeCurrency"];_.subscribe(function(e,t){if(e.payload&&!e.payload.bypassEncodeURL&&l.a.includes(C,e.type)){var r=y.a.AES.encrypt(u()((c=l.a.cloneDeep(t),(c=l.a.omit(c,["password","allCurrencies"])).currencies=l.a.map(c.currencies,function(e){return e.coinmarketcap={},e}),c)),t.password).toString(),n=v.a.compressToEncodedURIComponent(r);window.history.pushState("Rocket","To the moon","/"+n)}var c});var g={name:"CurrencyForm",props:["currency","on-submit","on-cancel","submit-label"],methods:{handleSubmit:function(e){this.onSubmit(e)}},data:function(){return{localCurrency:l.a.cloneDeep(this.currency||h)}},computed:{allCurrencies:function(){return this.$store.state.allCurrencies}}},k={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("form",{on:{submit:function(t){t.preventDefault(),e.handleSubmit(e.localCurrency)}}},[r("el-select",{attrs:{filterable:"",placeholder:"Select"},model:{value:e.localCurrency.id,callback:function(t){e.$set(e.localCurrency,"id",t)},expression:"localCurrency.id"}},e._l(e.allCurrencies,function(e){return r("el-option",{key:e.slug,attrs:{label:e.name,value:e.slug}})})),e._v(" "),r("el-input",{attrs:{type:"number",placeholder:"quantity"},model:{value:e.localCurrency.quantity,callback:function(t){e.$set(e.localCurrency,"quantity",t)},expression:"localCurrency.quantity"}}),e._v(" "),r("el-input",{attrs:{type:"number",placeholder:"cost"},model:{value:e.localCurrency.cost,callback:function(t){e.$set(e.localCurrency,"cost",t)},expression:"localCurrency.cost"}}),e._v(" "),r("el-select",{attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":"","no-data-text":"Create a new tag",placeholder:"Choose tags for your currency"},model:{value:e.localCurrency.tags,callback:function(t){e.$set(e.localCurrency,"tags",t)},expression:"localCurrency.tags"}},e._l(e.localCurrency.tags,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})})),e._v(" "),r("el-input",{attrs:{type:"textarea"},model:{value:e.localCurrency.info,callback:function(t){e.$set(e.localCurrency,"info",t)},expression:"localCurrency.info"}}),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.handleSubmit(e.localCurrency)}}},[e._v("\n    "+e._s(e.submitLabel)+"\n  ")]),e._v(" "),r("el-button",{on:{click:function(t){e.onCancel()}}},[e._v("\n    Cancel\n  ")])],1)},staticRenderFns:[]},F={name:"AddCurrency",props:["type","currency"],components:{CurrencyForm:r("VU/8")(g,k,!1,null,null,null).exports},data:function(){return{modalVisible:!1,modalTypes:{add:{buttonIcon:"el-icon-plus",buttonLabel:"Add new currency",title:"Add new currency",submitLabel:"Add new currency",method:"addCurrency"},update:{buttonIcon:"el-icon-edit",buttonLabel:"",title:"Edit currency",submitLabel:"Update currency",method:"updateCurrency"}}}},computed:{isAllCurrenciesEmpty:function(){return 0===this.$store.state.allCurrencies.length}},methods:{closeModal:function(){this.modalVisible=!1,this.$refs.dialog.$data.rendered=!1},onSubmit:function(e){this.$store.dispatch("fetchCurrency",{method:this.modalTypes[this.type].method,currency:e,callback:this.closeModal})}}},S={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",[r("el-button",{attrs:{type:"primary",size:"update"===e.type?"mini":"",disabled:e.isAllCurrenciesEmpty,icon:e.modalTypes[e.type].buttonIcon},on:{click:function(t){e.modalVisible=!0}}},[e._v("\n    "+e._s(e.modalTypes[e.type].buttonLabel)+"\n  ")]),e._v(" "),r("el-dialog",{ref:"dialog",attrs:{"before-close":e.closeModal,title:e.modalTypes[e.type].title,visible:e.modalVisible,fullscreen:""},on:{"update:visible":function(t){e.modalVisible=t}}},[r("currency-form",{attrs:{type:e.type,currency:e.currency,"submit-label":e.modalTypes[e.type].submitLabel,"on-cancel":e.closeModal,"on-submit":e.onSubmit}})],1)],1)},staticRenderFns:[]},w=r("VU/8")(F,S,!1,null,null,null).exports,E={methods:{formatNumber:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.toLocaleString("fr-FR",o()({maximumFractionDigits:2},t))}}},R={name:"Currency",props:["currency"],mixins:[E],components:{CurrencyModal:w},computed:o()({},Object(i.b)(["total"])),methods:{price:function(e){return parseFloat(e.coinmarketcap.price_eur)},tags:function(e){if(!l.a.isEmpty(e.tags))return e.tags.join(", ")},info:function(e){if(!l.a.isEmpty(e.info))return e.info},value:function(e){return parseFloat(e.coinmarketcap.price_eur)*parseFloat(e.quantity)},performance:function(e){return(this.value(e)-parseFloat(e.cost))/parseFloat(e.cost)},distribution:function(e){return parseFloat(e.cost)/this.total.cost},removeCurrency:function(e){this.$store.commit("removeCurrency",e)}}},$={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h3",[r("img",{attrs:{src:"https://files.coinmarketcap.com/static/img/coins/32x32/"+e.currency.id+".png",height:"24",width:"24"}}),e._v("\n    "+e._s(e.currency.coinmarketcap.name)+"\n    "+e._s(e.formatNumber(e.price(e.currency),{style:"currency",currency:"EUR"}))+"\n  ")]),e._v(" "),r("div",[e._v("\n    quantity: "+e._s(e.formatNumber(parseFloat(e.currency.quantity)))+"\n  ")]),e._v(" "),r("div",[e._v("\n    cost: "+e._s(e.formatNumber(parseFloat(e.currency.cost),{style:"currency",currency:"EUR"}))+"\n    "),r("small",[e._v("("+e._s(e.formatNumber(e.distribution(e.currency),{style:"percent"}))+")")])]),e._v(" "),r("div",[e._v("\n    value: "+e._s(e.formatNumber(e.value(e.currency),{style:"currency",currency:"EUR"}))+"\n    "),r("small",[e._v("("+e._s(e.formatNumber(e.performance(e.currency),{style:"percent"}))+")")])]),e._v(" "),e.tags(e.currency)?r("div",[e._v("tags: "+e._s(e.tags(e.currency)))]):e._e(),e._v(" "),e.info(e.currency)?r("div",[e._v("info: "+e._s(e.info(e.currency)))]):e._e(),e._v(" "),r("el-button",{attrs:{size:"mini",icon:"el-icon-delete",type:"danger"},on:{click:function(t){e.removeCurrency(e.currency)}}}),e._v(" "),r("currency-modal",{attrs:{type:"update",currency:e.currency}})],1)},staticRenderFns:[]},x={name:"CurrenciesList",components:{Currency:r("VU/8")(R,$,!1,null,null,null).exports},computed:o()({},Object(i.b)(["filteredCurrencies"]))},A={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",this._l(this.filteredCurrencies,function(e,r){return t("div",{key:e.id+""+r},[t("currency",{attrs:{currency:e}})],1)}))},staticRenderFns:[]},U=r("VU/8")(x,A,!1,null,null,null).exports,q={name:"CurrenciesSort",computed:{currentSort:function(){return l.a.find(b,{key:this.$store.state.sort.by})},sorts:function(){return b}},methods:{handleSort:function(e){this.$store.commit("updateSort",e)}}},T={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dropdown",{on:{command:e.handleSort}},[r("span",{staticClass:"el-dropdown-link"},[e._v("\n    "+e._s(e.currentSort.name)),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.sorts,function(t){return r("el-dropdown-item",{key:t.key,attrs:{command:t.key}},[e._v("\n      "+e._s(t.name)+"\n    ")])}))],1)},staticRenderFns:[]},N=r("VU/8")(q,T,!1,null,null,null).exports,L={name:"CurrenciesFilters",computed:o()({selectedTags:function(){return this.$store.state.filters.tags}},Object(i.b)(["tags"])),methods:{handleSelect:function(e){this.$store.commit("updateTags",e)}}},V={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-select",{attrs:{value:e.selectedTags,multiple:"",placeholder:"Select"},on:{change:e.handleSelect}},e._l(e.tags,function(e){return r("el-option",{key:e,attrs:{label:e,value:e}})}))},staticRenderFns:[]},O={name:"App",mixins:[E],components:{CurrencyModal:w,CurrenciesList:U,CurrenciesSort:N,CurrenciesFilters:r("VU/8")(L,V,!1,null,null,null).exports},computed:o()({},Object(i.b)(["total"])),methods:{uniqueId:function(){return l.a.uniqueId()}},created:function(){this.$store.dispatch("fetchAllCurrencies")}},M={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.total.value?r("div",[r("h1",[e._v("\n    "+e._s(e.formatNumber(e.total.value,{style:"currency",currency:"EUR"}))+"\n    "),r("small",[e._v("\n      ("+e._s(e.formatNumber(e.total.performance,{style:"percent"}))+")\n    ")])]),e._v(" "),r("currencies-sort"),e._v(" "),r("currencies-filters"),e._v(" "),r("currency-modal",{attrs:{type:"add","button-label":"Add new currency","button-icon":"el-icon-plus"}}),e._v(" "),r("currencies-list")],1):r("div",[r("h1",[e._v("Welcome to Cryptos")]),e._v(" "),r("currency-modal",{attrs:{type:"add","button-label":"Start Your Portfolio","button-icon":""}})],1)},staticRenderFns:[]};var j=r("VU/8")(O,M,!1,function(e){r("RcQw")},null,null).exports,I=r("zL8q"),D=r.n(I);r("tvR6");n.default.config.productionTip=!1,n.default.use(D.a),new n.default({el:"#app",store:_,beforeCreate:function(){this.$store.commit("initialiseStore")},components:{App:j},template:"<App/>"})},RcQw:function(e,t){},tvR6:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.547a356bde6759798e4a.js.map